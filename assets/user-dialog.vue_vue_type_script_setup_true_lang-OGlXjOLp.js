import{d as e,a as l,c as a,r,w as s,y as o,f as t,z as u,p as d,u as m,e as i,G as n,H as p,h as g,l as f,I as b,N as v,n as c}from"./index-CKM1fen8.js";import{E as y}from"./el-dialog-CH-fnEoz.js";import"./el-overlay-Bft6Qiui.js";import{E as h}from"./el-button-DoyUgqJB.js";import{E as V,a as j}from"./el-form-item-By2N_a5b.js";/* empty css               */import{E as _,a as x}from"./el-option-DisnDj8j.js";/* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 */import{R as E}from"./formData-BXYWt-zH.js";import{E as w}from"./index-B7I_vG9C.js";const C={class:"dialog-footer"},D=e({__name:"user-dialog",props:{visible:{type:Boolean},type:{},userData:{}},emits:["update:visible","submit"],setup(e,{emit:D}){const U=e,k=D,q=l(E),R=a({get:()=>U.visible,set:e=>k("update:visible",e)}),A=a(()=>U.type),N=l(),P=r({username:"",phone:"",gender:"男",role:[]}),z={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号格式",trigger:"blur"}],gender:[{required:!0,message:"请选择性别",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"blur"}]};s(()=>[U.visible,U.type,U.userData],([e])=>{e&&((()=>{const e="edit"===U.type&&U.userData,l=U.userData;Object.assign(P,{username:e&&l&&l.userName||"",phone:e&&l&&l.userPhone||"",gender:e&&l&&l.userGender||"男",role:e&&l&&Array.isArray(l.userRoles)?l.userRoles:[]})})(),c(()=>{var e;null==(e=N.value)||e.clearValidate()}))},{immediate:!0});const B=()=>{return e=null,l=null,a=function*(){N.value&&(yield N.value.validate(e=>{e&&(v.success("add"===A.value?"添加成功":"更新成功"),R.value=!1,k("submit"))}))},new Promise((r,s)=>{var o=e=>{try{u(a.next(e))}catch(l){s(l)}},t=e=>{try{u(a.throw(e))}catch(l){s(l)}},u=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,t);u((a=a.apply(e,l)).next())});var e,l,a};return(e,l)=>{const a=w,r=j,s=x,v=_,c=V,E=h,D=y;return t(),o(D,{modelValue:m(R),"onUpdate:modelValue":l[5]||(l[5]=e=>b(R)?R.value=e:null),title:"add"===m(A)?"添加用户":"编辑用户",width:"30%","align-center":""},{footer:u(()=>[g("div",C,[d(E,{onClick:l[4]||(l[4]=e=>R.value=!1)},{default:u(()=>[...l[6]||(l[6]=[f("取消",-1)])]),_:1}),d(E,{type:"primary",onClick:B},{default:u(()=>[...l[7]||(l[7]=[f("提交",-1)])]),_:1})])]),default:u(()=>[d(c,{ref_key:"formRef",ref:N,model:m(P),rules:z,"label-width":"80px"},{default:u(()=>[d(r,{label:"用户名",prop:"username"},{default:u(()=>[d(a,{modelValue:m(P).username,"onUpdate:modelValue":l[0]||(l[0]=e=>m(P).username=e),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),d(r,{label:"手机号",prop:"phone"},{default:u(()=>[d(a,{modelValue:m(P).phone,"onUpdate:modelValue":l[1]||(l[1]=e=>m(P).phone=e),placeholder:"请输入手机号"},null,8,["modelValue"])]),_:1}),d(r,{label:"性别",prop:"gender"},{default:u(()=>[d(v,{modelValue:m(P).gender,"onUpdate:modelValue":l[2]||(l[2]=e=>m(P).gender=e)},{default:u(()=>[d(s,{label:"男",value:"男"}),d(s,{label:"女",value:"女"})]),_:1},8,["modelValue"])]),_:1}),d(r,{label:"角色",prop:"role"},{default:u(()=>[d(v,{modelValue:m(P).role,"onUpdate:modelValue":l[3]||(l[3]=e=>m(P).role=e),multiple:""},{default:u(()=>[(t(!0),i(n,null,p(m(q),e=>(t(),o(s,{key:e.roleCode,value:e.roleCode,label:e.roleName},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}});export{D as _};
