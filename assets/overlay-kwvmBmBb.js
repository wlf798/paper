var e=Object.defineProperty,n=Object.defineProperties,o=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,l=(n,o,t)=>o in n?e(n,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[o]=t,r=(e,n)=>{for(var o in n||(n={}))a.call(n,o)&&l(e,o,n[o]);if(t)for(var o of t(n))s.call(n,o)&&l(e,o,n[o]);return e},i=(e,n,o)=>new Promise((t,a)=>{var s=e=>{try{r(o.next(e))}catch(n){a(n)}},l=e=>{try{r(o.throw(e))}catch(n){a(n)}},r=e=>e.done?t(e.value):Promise.resolve(e.value).then(s,l);r((o=o.apply(e,n)).next())});import{n as c,U as u,V as d,_ as p,d as f,E as m,y as g,f as v,z as b,J as y,p as h,h as C,i as x,az as E,g as w,e as B,k,at as I,m as M,B as T,j as P,ab as j,l as O,Y as z,cy as L,aa as S,cz as A,c as R,a as V,r as _,cA as $,bb as D,cB as K,w as H,o as q,b as U,t as F,b2 as J,a9 as W,bk as Y,bo as Z,cC as G,c2 as N,af as Q,bV as X,a5 as ee}from"./index-DuNn1tT0.js";import{E as ne}from"./el-button-Cu-8GITI.js";import{E as oe}from"./index-DKGOt7-B.js";import{E as te,u as ae,a as se}from"./index-jtkC1QNG.js";import{E as le}from"./index-Cwozh5L4.js";import{o as re}from"./aria-Dle50h-X.js";import{i as ie}from"./validator-AtrFltAN.js";import{u as ce}from"./index-B54hCvU_.js";import{u as ue}from"./index-CS4yvE_C.js";const de="_trap-focus-children",pe=[],fe=e=>{if(0===pe.length)return;const n=u(e),o=pe[pe.length-1][de];if(o.length>0&&n===d.tab){if(1===o.length)return e.preventDefault(),void(document.activeElement!==o[0]&&o[0].focus());const n=e.shiftKey,t=e.target===o[0],a=e.target===o[o.length-1];t&&n&&(e.preventDefault(),o[o.length-1].focus()),a&&!n&&(e.preventDefault(),o[0].focus())}};var me=p(f({name:"ElMessageBox",directives:{TrapFocus:{beforeMount(e){e[de]=re(e),pe.push(e),pe.length<=1&&document.addEventListener("keydown",fe)},updated(e){c(()=>{e[de]=re(e)})},unmounted(){pe.shift(),0===pe.length&&document.removeEventListener("keydown",fe)}}},components:r({ElButton:ne,ElFocusTrap:le,ElInput:oe,ElOverlay:te,ElIcon:S},L),inheritAttrs:!1,props:{buttonSize:{type:String,validator:ie},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,overflow:Boolean,roundButton:Boolean,container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(e,{emit:t}){const{locale:a,zIndex:s,ns:l,size:u}=A("message-box",R(()=>e.buttonSize)),{t:d}=a,{nextZIndex:p}=s,f=V(!1),m=_({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",closeIcon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:"",inputValidator:void 0,inputErrorMessage:"",message:"",modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonLoadingIcon:$(D),cancelButtonLoadingIcon:$(D),confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:p()}),g=R(()=>{const e=m.type;return{[l.bm("icon",e)]:e&&K[e]}}),v=ce(),b=ce(),y=R(()=>{const e=m.type;return m.icon||e&&K[e]||""}),h=R(()=>!!m.message),C=V(),x=V(),E=V(),w=V(),B=V(),k=R(()=>m.confirmButtonClass);H(()=>m.inputValue,n=>i(null,null,function*(){yield c(),"prompt"===e.boxType&&n&&L()}),{immediate:!0}),H(()=>f.value,n=>{var o,t;n&&("prompt"!==e.boxType&&(m.autofocus?E.value=null!=(t=null==(o=B.value)?void 0:o.$el)?t:C.value:E.value=C.value),m.zIndex=p()),"prompt"===e.boxType&&(n?c().then(()=>{var e;w.value&&w.value.$el&&(m.autofocus?E.value=null!=(e=S())?e:C.value:E.value=C.value)}):(m.editorErrorMessage="",m.validateError=!1))});const I=R(()=>e.draggable),M=R(()=>e.overflow),{isDragging:T}=ue(C,x,I,M);function P(){f.value&&(f.value=!1,c(()=>{m.action&&t("action",m.action)}))}q(()=>i(null,null,function*(){yield c(),e.closeOnHashChange&&window.addEventListener("hashchange",P)})),U(()=>{e.closeOnHashChange&&window.removeEventListener("hashchange",P)});const j=()=>{e.closeOnClickModal&&z(m.distinguishCancelAndClose?"close":"cancel")},O=se(j),z=n=>{var o;("prompt"!==e.boxType||"confirm"!==n||L())&&(m.action=n,m.beforeClose?null==(o=m.beforeClose)||o.call(m,n,m,P):P())},L=()=>{if("prompt"===e.boxType){const e=m.inputPattern;if(e&&!e.test(m.inputValue||""))return m.editorErrorMessage=m.inputErrorMessage||d("el.messagebox.error"),m.validateError=!0,!1;const n=m.inputValidator;if(J(n)){const e=n(m.inputValue);if(!1===e)return m.editorErrorMessage=m.inputErrorMessage||d("el.messagebox.error"),m.validateError=!0,!1;if(W(e))return m.editorErrorMessage=e,m.validateError=!0,!1}}return m.editorErrorMessage="",m.validateError=!1,!0},S=()=>{var e,n;const o=null==(e=w.value)?void 0:e.$refs;return null!=(n=null==o?void 0:o.input)?n:null==o?void 0:o.textarea},Y=()=>{z("close")};return e.lockScroll&&ae(f),Z=r({},F(m)),n(Z,o({ns:l,overlayEvent:O,visible:f,hasMessage:h,typeClass:g,contentId:v,inputId:b,btnSize:u,iconComponent:y,confirmButtonClasses:k,rootRef:C,focusStartRef:E,headerRef:x,inputRef:w,isDragging:T,confirmRef:B,doClose:P,handleClose:Y,onCloseRequested:()=>{e.closeOnPressEscape&&Y()},handleWrapperClick:j,handleInputEnter:e=>{if("textarea"!==m.inputType)return e.preventDefault(),z("confirm")},handleAction:z,t:d}));var Z}}),[["render",function(e,n,o,t,a,s){const l=m("el-icon"),r=m("el-input"),i=m("el-button"),c=m("el-focus-trap"),u=m("el-overlay");return v(),g(z,{name:"fade-in-linear",onAfterLeave:n=>e.$emit("vanish"),persisted:""},{default:b(()=>[y(h(u,{"z-index":e.zIndex,"overlay-class":[e.ns.is("message-box"),e.modalClass],mask:e.modal},{default:b(()=>[C("div",{role:"dialog","aria-label":e.title,"aria-modal":"true","aria-describedby":e.showInput?void 0:e.contentId,class:x(`${e.ns.namespace.value}-overlay-message-box`),onClick:e.overlayEvent.onClick,onMousedown:e.overlayEvent.onMousedown,onMouseup:e.overlayEvent.onMouseup},[h(c,{loop:"",trapped:e.visible,"focus-trap-el":e.rootRef,"focus-start-el":e.focusStartRef,onReleaseRequested:e.onCloseRequested},{default:b(()=>[C("div",{ref:"rootRef",class:x([e.ns.b(),e.customClass,e.ns.is("draggable",e.draggable),e.ns.is("dragging",e.isDragging),{[e.ns.m("center")]:e.center}]),style:w(e.customStyle),tabindex:"-1",onClick:E(()=>{},["stop"])},[null!==e.title&&void 0!==e.title?(v(),B("div",{key:0,ref:"headerRef",class:x([e.ns.e("header"),{"show-close":e.showClose}])},[C("div",{class:x(e.ns.e("title"))},[e.iconComponent&&e.center?(v(),g(l,{key:0,class:x([e.ns.e("status"),e.typeClass])},{default:b(()=>[(v(),g(I(e.iconComponent)))]),_:1},8,["class"])):k("v-if",!0),C("span",null,M(e.title),1)],2),e.showClose?(v(),B("button",{key:0,type:"button",class:x(e.ns.e("headerbtn")),"aria-label":e.t("el.messagebox.close"),onClick:n=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel"),onKeydown:T(E(n=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel"),["prevent"]),["enter"])},[h(l,{class:x(e.ns.e("close"))},{default:b(()=>[(v(),g(I(e.closeIcon||"close")))]),_:1},8,["class"])],42,["aria-label","onClick","onKeydown"])):k("v-if",!0)],2)):k("v-if",!0),C("div",{id:e.contentId,class:x(e.ns.e("content"))},[C("div",{class:x(e.ns.e("container"))},[e.iconComponent&&!e.center&&e.hasMessage?(v(),g(l,{key:0,class:x([e.ns.e("status"),e.typeClass])},{default:b(()=>[(v(),g(I(e.iconComponent)))]),_:1},8,["class"])):k("v-if",!0),e.hasMessage?(v(),B("div",{key:1,class:x(e.ns.e("message"))},[P(e.$slots,"default",{},()=>[e.dangerouslyUseHTMLString?(v(),g(I(e.showInput?"label":"p"),{key:1,for:e.showInput?e.inputId:void 0,innerHTML:e.message},null,8,["for","innerHTML"])):(v(),g(I(e.showInput?"label":"p"),{key:0,for:e.showInput?e.inputId:void 0,textContent:M(e.message)},null,8,["for","textContent"]))])],2)):k("v-if",!0)],2),y(C("div",{class:x(e.ns.e("input"))},[h(r,{id:e.inputId,ref:"inputRef",modelValue:e.inputValue,"onUpdate:modelValue":n=>e.inputValue=n,type:e.inputType,placeholder:e.inputPlaceholder,"aria-invalid":e.validateError,class:x({invalid:e.validateError}),onKeydown:T(e.handleInputEnter,["enter"])},null,8,["id","modelValue","onUpdate:modelValue","type","placeholder","aria-invalid","class","onKeydown"]),C("div",{class:x(e.ns.e("errormsg")),style:w({visibility:e.editorErrorMessage?"visible":"hidden"})},M(e.editorErrorMessage),7)],2),[[j,e.showInput]])],10,["id"]),C("div",{class:x(e.ns.e("btns"))},[e.showCancelButton?(v(),g(i,{key:0,loading:e.cancelButtonLoading,"loading-icon":e.cancelButtonLoadingIcon,class:x([e.cancelButtonClass]),round:e.roundButton,size:e.btnSize,onClick:n=>e.handleAction("cancel"),onKeydown:T(E(n=>e.handleAction("cancel"),["prevent"]),["enter"])},{default:b(()=>[O(M(e.cancelButtonText||e.t("el.messagebox.cancel")),1)]),_:1},8,["loading","loading-icon","class","round","size","onClick","onKeydown"])):k("v-if",!0),y(h(i,{ref:"confirmRef",type:"primary",loading:e.confirmButtonLoading,"loading-icon":e.confirmButtonLoadingIcon,class:x([e.confirmButtonClasses]),round:e.roundButton,disabled:e.confirmButtonDisabled,size:e.btnSize,onClick:n=>e.handleAction("confirm"),onKeydown:T(E(n=>e.handleAction("confirm"),["prevent"]),["enter"])},{default:b(()=>[O(M(e.confirmButtonText||e.t("el.messagebox.confirm")),1)]),_:1},8,["loading","loading-icon","class","round","disabled","size","onClick","onKeydown"]),[[j,e.showConfirmButton]])],2)],14,["onClick"])]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,["aria-label","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["z-index","overlay-class","mask"]),[[j,e.visible]])]),_:3},8,["onAfterLeave"])}],["__file","index.vue"]]);const ge=new Map,ve=(e,n,o=null)=>{const t=h(me,e,J(e.message)||Z(e.message)?{default:J(e.message)?e.message:()=>e.message}:null);return t.appContext=o,G(t,n),(e=>{let n=document.body;return e.appendTo&&(W(e.appendTo)&&(n=document.querySelector(e.appendTo)),X(e.appendTo)&&(n=e.appendTo),X(n)||(n=document.body)),n})(e).appendChild(n.firstElementChild),t.component},be=(e,n)=>{const o=document.createElement("div");e.onVanish=()=>{G(null,o),ge.delete(a)},e.onAction=n=>{const o=ge.get(a);let s;s=e.showInput?{value:a.inputValue,action:n}:n,e.callback?e.callback(s,t.proxy):"cancel"===n||"close"===n?e.distinguishCancelAndClose&&"cancel"!==n?o.reject("close"):o.reject("cancel"):o.resolve(s)};const t=ve(e,o,n),a=t.proxy;for(const s in e)N(e,s)&&!N(a.$props,s)&&("closeIcon"===s&&Q(e[s])?a[s]=$(e[s]):a[s]=e[s]);return a.visible=!0,a};function ye(e,n=null){if(!Y)return Promise.reject();let o;return W(e)||Z(e)?e={message:e}:o=e.callback,new Promise((t,a)=>{const s=be(e,null!=n?n:ye._context);ge.set(s,{options:e,callback:o,resolve:t,reject:a})})}const he={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};["alert","confirm","prompt"].forEach(e=>{ye[e]=function(e){return(n,o,t,a)=>{let s="";return Q(o)?(t=o,s=""):s=ee(o)?"":o,ye(Object.assign(r({title:s,message:n,type:""},he[e]),t,{boxType:e}),a)}}(e)}),ye.close=()=>{ge.forEach((e,n)=>{n.doClose()}),ge.clear()},ye._context=null;const Ce=ye;Ce.install=e=>{Ce._context=e._context,e.config.globalProperties.$msgbox=Ce,e.config.globalProperties.$messageBox=Ce,e.config.globalProperties.$alert=Ce.alert,e.config.globalProperties.$confirm=Ce.confirm,e.config.globalProperties.$prompt=Ce.prompt};const xe=Ce;export{xe as E};
