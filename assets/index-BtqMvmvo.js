var e=Object.defineProperty,s=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,o=(s,a,t)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t;import{d as r,dD as i,x as n,D as c,a as p,c as u,F as m,e as f,f as x,h as b,m as g,p as v,z as h,l as y,k as _,G as j,H as k,y as w,J as R,u as A,aa as E,a3 as P,dE as S,dF as O,N as U}from"./index-CKM1fen8.js";import{a as z,E as L}from"./el-table-column-BPAN9kPJ.js";/* empty css                    *//* empty css                   *//* empty css                  *//* empty css                     *//* empty css               *//* empty css                  */import{E as M}from"./el-button-DoyUgqJB.js";/* empty css                        */import{E as D,a as N,b as I}from"./el-dropdown-item-CmVgw-He.js";import{E as C}from"./el-alert-BtFcUE_W.js";import{E as F}from"./el-card-CJ1sCfRg.js";import{u as J}from"./useAuth-CIpZtw2C.js";import{E as $}from"./index-N7bjZI1X.js";import{E as G}from"./index-D_6TXvdw.js";import"./index-DayQJJrD.js";import"./index-DmtduCk7.js";import"./index-pB6x8TE-.js";import"./index-Ba5jcMC5.js";import"./aria-Dle50h-X.js";import"./index-C0mez0sX.js";import"./use-form-common-props-DQZcihQX.js";import"./_initCloneObject-CLrXHQUW.js";import"./isArrayLikeObject-Bhjbp35m.js";import"./raf-yHvaB8QX.js";import"./_baseIteratee-DrESJfWH.js";import"./castArray-DlxkTWHs.js";import"./debounce-DTnqz5uK.js";import"./toNumber-D96i-_vD.js";import"./index-BGUO9W0G.js";import"./event-BwRzfsZt.js";import"./index-BM2-Y4df.js";import"./index-e96-4aEG.js";import"./refs-Cw5r5QN8.js";import"./validator-7CwAUGKe.js";const V={class:"w-full py-2"},B={class:"mb-6"},H={class:"m-0 mb-2 text-xl font-medium"},W={class:"mb-6"},X={class:"flex items-start mb-4 last:mb-0"},Y={class:"flex items-start mb-4 last:mb-0"},Q={class:"flex flex-wrap gap-2"},Z={key:0,class:"italic text-red-500"},q={class:"mb-6 last:mb-0"},K={class:"grid grid-cols-[repeat(auto-fit,minmax(280px,1fr))] gap-5"},T={class:"flex flex-col gap-2"},ee={class:"flex flex-col gap-2"},se={class:"flex flex-col gap-2"},ae={class:"mb-6 last:mb-0"},te={class:"flex-cb font-semibold"},le={class:"mb-5"},de={class:"max-h-30 p-3 overflow-y-auto font-mono text-xs break-all whitespace-pre-wrap bg-g-200 border-full-d rounded"},oe={class:"grid grid-cols-[repeat(auto-fit,minmax(280px,1fr))] gap-5"},re={class:"flex flex-col gap-2"},ie={class:"flex flex-col gap-2"},ne={class:"flex flex-col gap-2"},ce={class:"flex flex-col gap-2"},pe={class:"mt-4"},ue={class:"mb-6 last:mb-0"},me={class:"flex-cb font-semibold"},fe={class:"mb-5"},xe={class:"max-h-30 p-3 overflow-y-auto font-mono text-xs break-all whitespace-pre-wrap bg-g-200 border-full-d rounded"},be={class:"grid grid-cols-[repeat(auto-fit,minmax(280px,1fr))] gap-5"},ge={class:"flex flex-col gap-2"},ve={class:"flex flex-col gap-2"},he={class:"flex flex-col gap-2"},ye={class:"mb-6 last:mb-0"},_e={class:"flex-cb font-semibold"},je={class:"grid grid-cols-[repeat(auto-fit,minmax(280px,1fr))] gap-5"},ke={class:"flex flex-col gap-2"},we={class:"flex flex-col gap-2"},Re={key:0,class:"flex gap-2 p-3 bg-g-200 border-full-d rounded"},Ae={key:1,class:"flex-c gap-2 p-3 text-g-500 bg-g-200 border border-dashed border-g-400 rounded"},Ee={class:"flex flex-col gap-2"},Pe={class:"flex flex-wrap gap-3"},Se={class:"mb-6 last:mb-0"},Oe={class:"mt-4"},Ue=r((ze=((e,s)=>{for(var a in s||(s={}))l.call(s,a)&&o(e,a,s[a]);if(t)for(var a of t(s))d.call(s,a)&&o(e,a,s[a]);return e})({},{name:"PermissionButtonAuth"}),s(ze,a({__name:"index",setup(e){const{hasAuth:s}=J(),{isFrontendMode:a}=i(),t=n(),l=c(),d=p(!1),o=u(()=>{var e,s;return(null==(s=null==(e=t.info)?void 0:e.roles)?void 0:s[0])||""}),r=u(()=>{var e;return(null==(e=t.info)?void 0:e.buttons)||[]}),Ue=u(()=>{var e;return(null==(e=t.info)?void 0:e.buttons)||[]}),ze=u(()=>Array.isArray(l.meta.authList)?l.meta.authList:[]),Le=u(()=>s("edit")||s("delete")||s("export")),Me=u(()=>[{feature:"权限来源",frontend:"用户状态中的 buttons 字段",backend:"路由配置中的 meta.authList"},{feature:"v-auth 指令",frontend:"不可用（前端模式下指令无效）",backend:"可用（根据路由权限配置检查）"},{feature:"hasAuth 方法",frontend:"可用（检查 buttons 数组）",backend:"可用（检查 meta.authList）"},{feature:"权限管理",frontend:"完全由前端控制，灵活度高",backend:"后端统一管理，安全性更高"},{feature:"适用场景",frontend:"快速原型、简单应用",backend:"企业级应用、复杂权限体系"}]),De=e=>({R_SUPER:"超级管理员",R_ADMIN:"管理员",R_USER:"普通用户"}[e]||"未知角色"),Ne=()=>{s("publish")?U.success("发布成功！"):U.warning("您没有发布权限")},Ie=e=>{const a={batchEdit:"批量编辑",batchDelete:"批量删除",batchExport:"批量导出"},t=e.replace("batch","").toLowerCase();s(t)?U.success(`${a[e]}操作执行成功！`):U.warning(`您没有${a[e]}权限`)};return(e,t)=>{const l=$,i=F,n=M,c=C,p=E,u=I,U=N,J=D,Ce=G,Fe=O,Je=L,$e=z,Ge=m("roles"),Ve=m("auth");return x(),f("div",V,[b("div",B,[b("h2",H,g(e.$t("menus.examples.permission.buttonAuth")),1),t[1]||(t[1]=b("p",{class:"m-0 text-sm leading-[1.6] text-g-700"}," 此页面演示按钮级别的权限控制，不同用户身份下可见的按钮会有所不同。权限控制基于用户角色和权限码实现。 ",-1))]),b("div",W,[v(i,{shadow:"never",class:"art-card-xs"},{header:h(()=>[...t[2]||(t[2]=[b("div",{class:"flex-cb font-semibold"},[b("span",{class:"flex-1"},"当前用户权限信息")],-1)])]),default:h(()=>{return[b("div",null,[b("div",X,[t[3]||(t[3]=b("span",{class:"min-w-20 font-semibold"},"用户角色：",-1)),v(l,{type:(e=o.value,{R_SUPER:"warning",R_ADMIN:"primary",R_USER:"success"}[e]||"info")},{default:h(()=>[y(g(De(o.value)),1)]),_:1},8,["type"])]),b("div",Y,[t[4]||(t[4]=b("span",{class:"min-w-20 font-semibold"},"权限码：",-1)),b("div",Q,[(x(!0),f(j,null,k(r.value,e=>(x(),w(l,{key:e,size:"small",type:"info",class:"m-0"},{default:h(()=>[y(g(e),1)]),_:2},1024))),128)),r.value.length?_("",!0):(x(),f("span",Z,"无权限码"))])])])];var e}),_:1})]),b("div",q,[v(i,{shadow:"never",class:"art-card-xs"},{header:h(()=>[...t[5]||(t[5]=[b("div",{class:"flex-cb font-semibold"},[b("span",{class:"flex-1"},"基于角色的权限控制（v-roles 指令）")],-1)])]),default:h(()=>[b("div",null,[t[12]||(t[12]=b("p",{class:"p-3 m-0 mb-5 text-sm leading-[1.6] text-g-700 bg-g-200 rounded"},[y(" 使用 "),b("code",{class:"px- 1.5 py-0.5 font-mono text-xs text-theme bg-theme/10 rounded"},"v-roles"),y(" 指令控制按钮显示，只有拥有指定角色的用户才能看到对应按钮。 ")],-1)),b("div",K,[b("div",T,[R((x(),w(n,{type:"primary",plain:""},{default:h(()=>[...t[6]||(t[6]=[y(" 超级管理员可见 ",-1)])]),_:1})),[[Ge,"R_SUPER"]]),t[7]||(t[7]=b("div",{class:"text-xs"},[b("code",{class:"block p-1 px-2 mb-1 font-mono bg-g-200 border-full-d rounded"},"v-roles=\"'R_SUPER'\""),b("span",{class:"text-g-700"},"只有超级管理员可见")],-1))]),b("div",ee,[R((x(),w(n,{type:"warning",plain:""},{default:h(()=>[...t[8]||(t[8]=[y(" 管理员可见 ",-1)])]),_:1})),[[Ge,["R_SUPER","R_ADMIN"]]]),t[9]||(t[9]=b("div",{class:"text-xs"},[b("code",{class:"block p-1 px-2 mb-1 font-mono bg-g-200 border-full-d rounded"},"v-roles=\"['R_SUPER', 'R_ADMIN']\""),b("span",{class:"text-g-700"},"超级管理员和管理员可见")],-1))]),b("div",se,[R((x(),w(n,{type:"success",plain:""},{default:h(()=>[...t[10]||(t[10]=[y(" 所有用户可见 ",-1)])]),_:1})),[[Ge,["R_SUPER","R_ADMIN","R_USER"]]]),t[11]||(t[11]=b("div",{class:"text-xs"},[b("code",{class:"block p-1 px-2 mb-1 font-mono bg-g-200 border-full-d rounded"},"v-roles=\"['R_SUPER', 'R_ADMIN', 'R_USER']\""),b("span",{class:"text-g-700"},"所有已登录用户可见")],-1))])])])]),_:1})]),b("div",ae,[v(i,{shadow:"never",class:"art-card-xs"},{header:h(()=>[b("div",te,[t[15]||(t[15]=b("span",{class:"flex-1"},"后端模式权限控制（v-auth 指令）",-1)),A(a)?(x(),w(l,{key:1,type:"info",size:"small"},{default:h(()=>[...t[14]||(t[14]=[y("非当前模式",-1)])]),_:1})):(x(),w(l,{key:0,type:"success",size:"small"},{default:h(()=>[...t[13]||(t[13]=[y("当前模式",-1)])]),_:1}))])]),default:h(()=>[b("div",null,[t[25]||(t[25]=b("p",{class:"p-3 m-0 mb-5 text-sm leading-[1.6] text-g-700 bg-g-200 rounded"},[b("code",{class:"px- 1.5 py-0.5 font-mono text-xs text-theme bg-theme/10 rounded"},"v-auth"),y(" 指令在后端模式下根据当前路由的 "),b("code",{class:"px- 1.5 py-0.5 font-mono text-xs text-theme bg-theme/10 rounded"},"meta.authList"),y(" 配置检查权限。 权限列表来源于路由元数据，适用于权限配置由后端统一管理的场景。 ")],-1)),b("div",le,[t[16]||(t[16]=b("h4",{class:"m-0 mb-2 text-sm font-semibold"}," 当前路由权限配置： ",-1)),b("div",de,[b("code",null,g(JSON.stringify(ze.value,null,2)),1)])]),b("div",oe,[b("div",re,[R((x(),w(n,{type:"primary",plain:""},{default:h(()=>[...t[17]||(t[17]=[y(" 新增 ",-1)])]),_:1})),[[Ve,"add"]]),t[18]||(t[18]=b("div",{class:"text-xs"},[b("code",{class:"block p-1 px-2 mb-1 font-mono bg-g-200 border-full-d rounded"},"v-auth=\"'add'\""),b("span",{class:"text-g-700"},"检查路由 meta.authList 中是否存在 authMark: 'add'")],-1))]),b("div",ie,[R((x(),w(n,{type:"warning",plain:""},{default:h(()=>[...t[19]||(t[19]=[y(" 编辑 ",-1)])]),_:1})),[[Ve,"edit"]]),t[20]||(t[20]=b("div",{class:"text-xs"},[b("code",{class:"block p-1 px-2 mb-1 font-mono bg-g-200 border-full-d rounded"},"v-auth=\"'edit'\""),b("span",{class:"text-g-700"},"检查路由 meta.authList 中是否存在 authMark: 'edit'")],-1))]),b("div",ne,[R((x(),w(n,{type:"danger",plain:""},{default:h(()=>[...t[21]||(t[21]=[y(" 删除 ",-1)])]),_:1})),[[Ve,"delete"]]),t[22]||(t[22]=b("div",{class:"text-xs"},[b("code",{class:"block p-1 px-2 mb-1 font-mono bg-g-200 border-full-d rounded"},"v-auth=\"'delete'\""),b("span",{class:"text-g-700"},"检查路由 meta.authList 中是否存在 authMark: 'delete'")],-1))]),b("div",ce,[R((x(),w(n,{type:"info",plain:""},{default:h(()=>[...t[23]||(t[23]=[y(" 导出 ",-1)])]),_:1})),[[Ve,"export"]]),t[24]||(t[24]=b("div",{class:"text-xs"},[b("code",{class:"block p-1 px-2 mb-1 font-mono bg-g-200 border-full-d rounded"},"v-auth=\"'export'\""),b("span",{class:"text-g-700"},"检查路由 meta.authList 中是否存在 authMark: 'export'")],-1))])]),b("div",pe,[v(c,{type:A(a)?"warning":"success",title:A(a)?"注意：当前为前端模式，v-auth 指令在后端模式下才生效":"当前为后端模式，v-auth 指令正常工作","show-icon":"",closable:!1},null,8,["type","title"])])])]),_:1})]),b("div",ue,[v(i,{shadow:"never",class:"art-card-xs"},{header:h(()=>[b("div",me,[t[28]||(t[28]=b("span",{class:"flex-1"},"前端模式权限控制（hasAuth 方法）",-1)),A(a)?(x(),w(l,{key:0,type:"success",size:"small"},{default:h(()=>[...t[26]||(t[26]=[y("当前模式",-1)])]),_:1})):(x(),w(l,{key:1,type:"info",size:"small"},{default:h(()=>[...t[27]||(t[27]=[y("非当前模式",-1)])]),_:1}))])]),default:h(()=>[b("div",null,[t[39]||(t[39]=b("p",{class:"p-3 m-0 mb-5 text-sm leading-[1.6] text-g-700 bg-g-200 rounded"},[b("code",{class:"px- 1.5 py-0.5 font-mono text-xs text-theme bg-theme/10 rounded"},"hasAuth"),y(" 方法在前端模式下根据用户信息中的 "),b("code",{class:"px- 1.5 py-0.5 font-mono text-xs text-theme bg-theme/10 rounded"},"buttons"),y(" 字段检查权限。 权限列表存储在用户状态中，适用于权限完全由前端管理的场景。 ")],-1)),b("div",fe,[t[29]||(t[29]=b("h4",{class:"m-0 mb-2 text-sm font-semibold"},"当前用户权限列表（buttons 字段）：",-1)),b("div",xe,[b("code",null,g(JSON.stringify(Ue.value,null,2)),1)])]),b("div",be,[b("div",ge,[A(s)("view")?(x(),w(n,{key:0,type:"primary"},{default:h(()=>[...t[30]||(t[30]=[y(" 查看详情 ",-1)])]),_:1})):(x(),w(n,{key:1,type:"info",disabled:""},{default:h(()=>[...t[31]||(t[31]=[y(" 无查看权限 ",-1)])]),_:1})),t[32]||(t[32]=b("div",{class:"text-xs"},[b("code",{class:"block p-1 px-2 mb-1 font-mono bg-g-200 border-full-d rounded"},"v-if=\"hasAuth('view')\""),b("span",{class:"text-g-700"},"检查用户 buttons 数组是否包含 'view'")],-1))]),b("div",ve,[v(n,{disabled:!A(s)("publish"),type:A(s)("publish")?"success":"info",onClick:Ne},{default:h(()=>[y(g(A(s)("publish")?"发布":"无发布权限"),1)]),_:1},8,["disabled","type"]),t[33]||(t[33]=b("div",{class:"text-xs"},[b("code",{class:"block p-1 px-2 mb-1 font-mono bg-g-200 border-full-d rounded"},":disabled=\"!hasAuth('publish')\""),b("span",{class:"text-g-700"},"检查用户 buttons 数组是否包含 'publish'")],-1))]),b("div",he,[v(J,{onCommand:Ie,disabled:!Le.value},{dropdown:h(()=>[v(U,null,{default:h(()=>[v(u,{command:"batchEdit",disabled:!A(s)("edit")},{default:h(()=>[...t[35]||(t[35]=[y(" 批量编辑 ",-1)])]),_:1},8,["disabled"]),v(u,{command:"batchDelete",disabled:!A(s)("delete")},{default:h(()=>[...t[36]||(t[36]=[y(" 批量删除 ",-1)])]),_:1},8,["disabled"]),v(u,{command:"batchExport",disabled:!A(s)("export")},{default:h(()=>[...t[37]||(t[37]=[y(" 批量导出 ",-1)])]),_:1},8,["disabled"])]),_:1})]),default:h(()=>[v(n,{type:Le.value?"warning":"info"},{default:h(()=>[t[34]||(t[34]=y(" 批量操作 ",-1)),v(p,{class:"el-icon--right"},{default:h(()=>[v(A(P))]),_:1})]),_:1},8,["type"])]),_:1},8,["disabled"]),t[38]||(t[38]=b("div",{class:"text-xs"},[b("code",{class:"block p-1 px-2 mb-1 font-mono bg-g-200 border-full-d rounded"},"computed(() => hasAuth('edit') || hasAuth('delete'))"),b("span",{class:"text-g-700"},"复合权限检查，检查多个权限的并集")],-1))])])])]),_:1})]),b("div",ye,[v(i,{shadow:"never",class:"art-card-xs"},{header:h(()=>[b("div",_e,[t[42]||(t[42]=b("span",{class:"flex-1"},"后端模式权限控制（hasAuth 方法）",-1)),A(a)?(x(),w(l,{key:1,type:"info",size:"small"},{default:h(()=>[...t[41]||(t[41]=[y("非当前模式",-1)])]),_:1})):(x(),w(l,{key:0,type:"success",size:"small"},{default:h(()=>[...t[40]||(t[40]=[y("当前模式",-1)])]),_:1}))])]),default:h(()=>[b("div",null,[t[52]||(t[52]=b("p",{class:"p-3 m-0 mb-5 text-sm leading-[1.6] text-g-700 bg-g-200 rounded"},[b("code",{class:"px- 1.5 py-0.5 font-mono text-xs text-theme bg-theme/10 rounded"},"hasAuth"),y(" 方法在后端模式下根据当前路由的 "),b("code",{class:"px- 1.5 py-0.5 font-mono text-xs text-theme bg-theme/10 rounded"},"meta.authList"),y(" 配置检查权限。与 v-auth 指令使用相同的权限来源，但提供编程式的权限检查能力。 ")],-1)),b("div",je,[b("div",ke,[v(Ce,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=e=>d.value=e),disabled:!A(s)("config"),"active-text":"功能开启","inactive-text":"功能关闭"},null,8,["modelValue","disabled"]),t[43]||(t[43]=b("div",{class:"text-xs"},[b("code",{class:"block p-1 px-2 mb-1 font-mono bg-g-200 border-full-d rounded"},":disabled=\"!hasAuth('config')\""),b("span",{class:"text-g-700"},"检查路由权限控制功能开关")],-1))]),b("div",we,[A(s)("manage")?(x(),f("div",Re,[v(n,{type:"primary",size:"small"},{default:h(()=>[...t[44]||(t[44]=[y("管理操作",-1)])]),_:1}),v(n,{type:"warning",size:"small"},{default:h(()=>[...t[45]||(t[45]=[y("高级设置",-1)])]),_:1})])):(x(),f("div",Ae,[v(p,null,{default:h(()=>[v(A(S))]),_:1}),t[46]||(t[46]=b("span",{class:"text-sm"},"需要管理权限才能查看此区域",-1))])),t[47]||(t[47]=b("div",{class:"text-xs"},[b("code",{class:"block p-1 px-2 mb-1 font-mono bg-g-200 border-full-d rounded"},"v-if=\"hasAuth('manage')\""),b("span",{class:"text-g-700"},"基于后端路由权限的条件渲染")],-1))]),b("div",Ee,[b("div",Pe,[v(Fe,{value:A(s)("add")?"✓":"✗",type:A(s)("add")?"success":"danger"},{default:h(()=>[v(n,{size:"small"},{default:h(()=>[...t[48]||(t[48]=[y("新增权限",-1)])]),_:1})]),_:1},8,["value","type"]),v(Fe,{value:A(s)("edit")?"✓":"✗",type:A(s)("edit")?"success":"danger"},{default:h(()=>[v(n,{size:"small"},{default:h(()=>[...t[49]||(t[49]=[y("编辑权限",-1)])]),_:1})]),_:1},8,["value","type"]),v(Fe,{value:A(s)("delete")?"✓":"✗",type:A(s)("delete")?"success":"danger"},{default:h(()=>[v(n,{size:"small"},{default:h(()=>[...t[50]||(t[50]=[y("删除权限",-1)])]),_:1})]),_:1},8,["value","type"])]),t[51]||(t[51]=b("div",{class:"text-xs"},[b("code",{class:"block p-1 px-2 mb-1 font-mono bg-g-200 border-full-d rounded"},"hasAuth('permission')"),b("span",{class:"text-g-700"},"实时权限状态指示器")],-1))])])])]),_:1})]),b("div",Se,[v(i,{shadow:"never",class:"art-card-xs"},{header:h(()=>[...t[53]||(t[53]=[b("div",{class:"flex-cb font-semibold"},[b("span",{class:"flex-1"},"权限控制模式对比")],-1)])]),default:h(()=>[b("div",null,[b("div",Oe,[v($e,{data:Me.value,border:""},{default:h(()=>[v(Je,{prop:"feature",label:"功能特性",width:"150"}),v(Je,{prop:"frontend",label:"前端模式"}),v(Je,{prop:"backend",label:"后端模式"})]),_:1},8,["data"])])])]),_:1})])])}}}))));var ze;export{Ue as default};
