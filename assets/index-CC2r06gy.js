var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,o=(t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a,i=(e,t)=>{for(var s in t||(t={}))r.call(t,s)&&o(e,s,t[s]);if(a)for(var s of a(t))l.call(t,s)&&o(e,s,t[s]);return e},n=(e,a)=>t(e,s(a));import{d as u,r as d,t as p,a as c,o as m,n as g,b as v,c as h,e as f,f as x,g as y,u as b,h as w,i as j,j as _,k,l as M,m as B,p as T,q as $,s as E,v as P,w as V,x as O,A as F,y as I,z as L,B as C,C as R,D as z,E as S,F as A,G as U,H as X,I as D,J as N,K as q,L as H,M as K}from"./index-DuNn1tT0.js";import{E as Y,a as G}from"./el-form-item-DKoSTcyf.js";import{E as J}from"./el-button-Cu-8GITI.js";/* empty css                    */import{_ as W}from"./index.vue_vue_type_script_setup_true_lang-D9lp4Hgf.js";import{_ as Q}from"./_plugin-vue_export-helper-BCo6x5W8.js";/* empty css                 *//* empty css               */import{E as Z,a as ee}from"./el-option-HDUlhA_A.js";/* empty css                  *//* empty css                     *//* empty css                  */import{_ as te,a as se}from"./LoginLeftView-BcvbftIj.js";import{E as ae}from"./index-DKGOt7-B.js";import{E as re}from"./index-Dwe9iiwQ.js";import"./use-form-common-props-YkJZMUeo.js";import"./castArray-CK2YYBjI.js";import"./index-CSnsSW2Y.js";import"./index-B54hCvU_.js";import"./_baseClone-lawoqp3c.js";import"./_initCloneObject-DfdnlAFm.js";import"./index-Qk1PgHVU.js";import"./index-BICMxtfg.js";import"./index-Cwozh5L4.js";import"./aria-Dle50h-X.js";import"./index-DM4EDxAy.js";import"./index-BHP5EuW7.js";import"./token-DWNpOE8r.js";import"./strings-DrkoAcI2.js";import"./event-BwRzfsZt.js";import"./scroll-C6vSq5CK.js";import"./debounce-CaRH_5Ar.js";import"./toNumber-U8DKyFfl.js";import"./_baseIteratee-Bx0whLuV.js";import"./index-CaqOoRuI.js";import"./vnode-Cc9CZV6n.js";/* empty css                        */import"./el-dropdown-item-BJwlQklQ.js";import"./refs-Cw5r5QN8.js";import"./useHeaderBar-ZLoK4cNb.js";import"./index-5nXZe9Rv.js";import"./index-I47MLRFf.js";const le=Q(u(n(i({},{name:"ArtDragVerify"}),{__name:"index",props:{value:{type:Boolean,default:!1},width:{default:"100%"},height:{default:40},text:{default:"按住滑块拖动"},successText:{default:"success"},background:{default:"#eee"},progressBarBg:{default:"#1385FF"},completedBg:{default:"#57D187"},circle:{type:Boolean,default:!1},radius:{default:"calc(var(--custom-radius) / 3 + 2px)"},handlerIcon:{default:"solar:double-alt-arrow-right-linear"},successIcon:{default:"ri:check-fill"},handlerBg:{default:"#fff"},textSize:{default:"13px"},textColor:{default:"#333"}},emits:["handlerMove","update:value","passCallback"],setup(e,{expose:t,emit:s}){const a=s,r=e,l=d({isMoving:!1,x:0,isOk:!1}),{isOk:o}=p(l),i=c(),n=c(),u=c(),$=c();let E,P,V,O;const F=e=>{E=e.targetTouches[0].pageX,P=e.targetTouches[0].pageY},I=e=>{V=e.targetTouches[0].pageX,O=e.targetTouches[0].pageY,Math.abs(V-E)>Math.abs(O-P)&&e.preventDefault()};document.addEventListener("touchstart",F),document.addEventListener("touchmove",I,{passive:!1});const L=()=>{var e;return"string"==typeof r.width?(null==(e=i.value)?void 0:e.offsetWidth)||260:r.width};m(()=>{var e;null==(e=i.value)||e.style.setProperty("--textColor",r.textColor),g(()=>{var e,t;const s=L();null==(e=i.value)||e.style.setProperty("--width",Math.floor(s/2)+"px"),null==(t=i.value)||t.style.setProperty("--pwidth",-Math.floor(s/2)+"px")}),document.addEventListener("touchstart",F),document.addEventListener("touchmove",I,{passive:!1})}),v(()=>{document.removeEventListener("touchstart",F),document.removeEventListener("touchmove",I)});const C={left:"0",width:r.height+"px",height:r.height+"px",background:r.handlerBg},R=h(()=>({width:"string"==typeof r.width?r.width:r.width+"px",height:r.height+"px",lineHeight:r.height+"px",background:r.background,borderRadius:r.circle?r.height/2+"px":r.radius})),z={background:r.progressBarBg,height:r.height+"px",borderRadius:r.circle?r.height/2+"px 0 0 "+r.height/2+"px":r.radius},S=h(()=>({fontSize:r.textSize})),A=h(()=>r.value?r.successText:r.text),U=e=>{r.value||(l.isMoving=!0,u.value.style.transition="none",l.x=(e.pageX||e.touches[0].pageX)-parseInt(u.value.style.left.replace("px",""),10)),a("handlerMove")},X=e=>{if(l.isMoving&&!r.value){const t=L();let s=(e.pageX||e.touches[0].pageX)-l.x;s>0&&s<=t-r.height?(u.value.style.left=s+"px",$.value.style.width=s+r.height/2+"px"):s>t-r.height&&(u.value.style.left=t-r.height+"px",$.value.style.width=t-r.height/2+"px",N())}},D=e=>{if(l.isMoving&&!r.value){const t=L();(e.pageX||e.changedTouches[0].pageX)-l.x<t-r.height?(l.isOk=!0,u.value.style.left="0",u.value.style.transition="all 0.2s",$.value.style.width="0",l.isOk=!1):(u.value.style.transition="none",u.value.style.left=t-r.height+"px",$.value.style.width=t-r.height/2+"px",N()),l.isMoving=!1}},N=()=>{a("update:value",!0),l.isMoving=!1,$.value.style.background=r.completedBg,n.value.style["-webkit-text-fill-color"]="unset",n.value.style.animation="slidetounlock2 2s cubic-bezier(0, 0.2, 1, 1) infinite",n.value.style.color="#fff",a("passCallback")};return t({reset:()=>{u.value.style.left="0",$.value.style.width="0",$.value.style.background=r.progressBarBg,n.value.style["-webkit-text-fill-color"]="transparent",n.value.style.animation="slidetounlock 2s cubic-bezier(0, 0.2, 1, 1) infinite",n.value.style.color=r.background,a("update:value",!1),l.isOk=!1,l.isMoving=!1,l.x=0}}),(t,s)=>{const a=W;return x(),f("div",{ref_key:"dragVerify",ref:i,class:"drag_verify",style:y(b(R)),onMousemove:X,onMouseup:D,onMouseleave:D,onTouchmove:X,onTouchend:D},[w("div",{class:j(["dv_progress_bar",{goFirst2:b(o)}]),ref_key:"progressBar",ref:$,style:z},null,2),w("div",{class:"dv_text",style:y(b(S)),ref_key:"messageRef",ref:n},[t.$slots.textBefore?_(t.$slots,"textBefore",{key:0},void 0,!0):k("",!0),M(" "+B(b(A))+" ",1),t.$slots.textAfter?_(t.$slots,"textAfter",{key:1},void 0,!0):k("",!0)],4),w("div",{class:j(["dv_handler dv_handler_bg",{goFirst:b(o)}]),onMousedown:U,onTouchstart:U,ref_key:"handler",ref:u,style:C},[T(a,{icon:e.value?e.successIcon:e.handlerIcon,class:"text-g-600"},null,8,["icon"])],34)],36)}}})),[["__scopeId","data-v-265b66f3"]]),oe={class:"flex w-full h-screen"},ie={class:"relative flex-1"},ne={class:"auth-right-wrap"},ue={class:"form"},de={class:"title"},pe={class:"sub-title"},ce={class:"relative pb-5 mt-6"},me={class:"flex-cb mt-2 text-sm"},ge={style:{"margin-top":"30px"}},ve={class:"mt-5 text-sm text-gray-600"},he=Q(u(n(i({},{name:"Login"}),{__name:"index",setup(e){const t=$(),{isDark:s}=E(t),{t:a,locale:r}=P(),l=c(0);V(r,()=>{l.value++});const o=h(()=>[{key:"super",label:a("login.roles.super"),userName:"Super",password:"123456",roles:["R_SUPER"]},{key:"admin",label:a("login.roles.admin"),userName:"Admin",password:"123456",roles:["R_ADMIN"]},{key:"user",label:a("login.roles.user"),userName:"User",password:"123456",roles:["R_USER"]}]),i=c(),n=O(),u=R(),p=z(),g=c(!1),v=c(!1),y=F.systemInfo.name,_=c(),k=d({account:"",username:"",password:"",rememberPassword:!0}),H=h(()=>({username:[{required:!0,message:a("login.placeholder.username"),trigger:"blur"}],password:[{required:!0,message:a("login.placeholder.password"),trigger:"blur"}]})),W=c(!1);m(()=>{Q("super")});const Q=e=>{var t,s;const a=o.value.find(t=>t.key===e);k.account=e,k.username=null!=(t=null==a?void 0:a.userName)?t:"",k.password=null!=(s=null==a?void 0:a.password)?s:""},he=()=>{return e=null,t=null,s=function*(){if(_.value)try{if(!(yield _.value.validate()))return;if(!g.value)return void(v.value=!0);W.value=!0;const{username:e,password:t}=k,{token:s,refreshToken:a}=yield q({userName:e,password:t});if(!s)throw new Error("Login failed - no token received");n.setToken(s,a),n.setLoginStatus(!0),xe();const r=p.query.redirect;u.push(r||"/")}catch(e){}finally{W.value=!1,fe()}},new Promise((a,r)=>{var l=e=>{try{i(s.next(e))}catch(t){r(t)}},o=e=>{try{i(s.throw(e))}catch(t){r(t)}},i=e=>e.done?a(e.value):Promise.resolve(e.value).then(l,o);i((s=s.apply(e,t)).next())});var e,t,s},fe=()=>{i.value.reset()},xe=()=>{setTimeout(()=>{K({title:a("login.success.title"),type:"success",duration:2500,zIndex:1e4,message:`${a("login.success.message")}, ${y}!`})},1e3)};return(e,t)=>{const a=te,r=se,n=ee,u=Z,d=G,p=ae,c=le,m=re,h=S("RouterLink"),y=J,$=Y,E=A("ripple");return x(),f("div",oe,[T(a),w("div",ie,[T(r),w("div",ne,[w("div",ue,[w("h3",de,B(e.$t("login.title")),1),w("p",pe,B(e.$t("login.subTitle")),1),(x(),I($,{ref_key:"formRef",ref:_,model:b(k),rules:b(H),key:b(l),onKeyup:C(he,["enter"]),style:{"margin-top":"25px"}},{default:L(()=>[T(d,{prop:"account"},{default:L(()=>[T(u,{modelValue:b(k).account,"onUpdate:modelValue":t[0]||(t[0]=e=>b(k).account=e),onChange:Q},{default:L(()=>[(x(!0),f(U,null,X(b(o),e=>(x(),I(n,{key:e.key,label:e.label,value:e.key},{default:L(()=>[w("span",null,B(e.label),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),T(d,{prop:"username"},{default:L(()=>[T(p,{class:"custom-height",placeholder:e.$t("login.placeholder.username"),modelValue:b(k).username,"onUpdate:modelValue":t[1]||(t[1]=e=>b(k).username=e),modelModifiers:{trim:!0}},null,8,["placeholder","modelValue"])]),_:1}),T(d,{prop:"password"},{default:L(()=>[T(p,{class:"custom-height",placeholder:e.$t("login.placeholder.password"),modelValue:b(k).password,"onUpdate:modelValue":t[2]||(t[2]=e=>b(k).password=e),modelModifiers:{trim:!0},type:"password",autocomplete:"off","show-password":""},null,8,["placeholder","modelValue"])]),_:1}),w("div",ce,[w("div",{class:j(["relative z-[2] overflow-hidden select-none rounded-lg border border-transparent tad-300",{"!border-[#FF4E4F]":!b(g)&&b(v)}])},[T(c,{ref_key:"dragVerify",ref:i,value:b(g),"onUpdate:value":t[3]||(t[3]=e=>D(g)?g.value=e:null),text:e.$t("login.sliderText"),textColor:"var(--art-gray-700)",successText:e.$t("login.sliderSuccessText"),progressBarBg:"var(--main-color)",background:b(s)?"#26272F":"#F1F1F4",handlerBg:"var(--default-box-color)"},null,8,["value","text","successText","background"])],2),w("p",{class:j(["absolute top-0 z-[1] px-px mt-2 text-xs text-[#f56c6c] tad-300",{"translate-y-10":!b(g)&&b(v)}])},B(e.$t("login.placeholder.slider")),3)]),w("div",me,[T(m,{modelValue:b(k).rememberPassword,"onUpdate:modelValue":t[4]||(t[4]=e=>b(k).rememberPassword=e)},{default:L(()=>[M(B(e.$t("login.rememberPwd")),1)]),_:1},8,["modelValue"]),T(h,{class:"text-theme",to:{name:"ForgetPassword"}},{default:L(()=>[M(B(e.$t("login.forgetPwd")),1)]),_:1})]),w("div",ge,[N((x(),I(y,{class:"w-full custom-height",type:"primary",onClick:he,loading:b(W)},{default:L(()=>[M(B(e.$t("login.btnText")),1)]),_:1},8,["loading"])),[[E]])]),w("div",ve,[w("span",null,B(e.$t("login.noAccount")),1),T(h,{class:"text-theme",to:{name:"Register"}},{default:L(()=>[M(B(e.$t("login.register")),1)]),_:1})])]),_:1},8,["model","rules"]))])])])])}}})),[["__scopeId","data-v-1c3db81c"]]);export{he as default};
