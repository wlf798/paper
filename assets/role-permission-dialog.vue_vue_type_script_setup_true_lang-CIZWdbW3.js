var e=Object.defineProperty,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,s=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{d as r,s as o,aG as n,a as u,c as d,w as c,y as i,f as h,z as m,p,aB as f,u as v,h as k,e as y,m as g,l as b,I as j,N as C}from"./index-CKM1fen8.js";import{E as x}from"./el-dialog-CH-fnEoz.js";import"./el-overlay-Bft6Qiui.js";import{E as _}from"./el-button-DoyUgqJB.js";/* empty css                     *//* empty css                *//* empty css                    *//* empty css                */import{E}from"./index-DayQJJrD.js";import{E as K}from"./index-DwsxGvSH.js";const V={style:{display:"flex","align-items":"center"}},O={key:0},w={key:1},M=r({__name:"role-permission-dialog",props:{modelValue:{type:Boolean,default:!1},roleData:{default:void 0}},emits:["update:modelValue","success"],setup(e,{emit:r}){const M=e,$=r,{menuList:B}=o(n()),H=u(),L=u(!0),N=u(!1),P=d({get:()=>M.modelValue,set:e=>$("update:modelValue",e)}),A=d(()=>{const e=r=>{var o,n;const u=((e,r)=>{for(var o in r||(r={}))l.call(r,o)&&s(e,o,r[o]);if(a)for(var o of a(r))t.call(r,o)&&s(e,o,r[o]);return e})({},r);if(null==(n=null==(o=r.meta)?void 0:o.authList)?void 0:n.length){const e=r.meta.authList.map(e=>({id:`${r.id}_${e.authMark}`,name:`${r.name}_${e.authMark}`,label:e.title,authMark:e.authMark,isAuth:!0,checked:e.checked||!1}));u.children=u.children?[...u.children,...e]:e}return u.children&&(u.children=u.children.map(e)),u};return B.value.map(e)}),D={children:"children",label:e=>{var a;return f(null==(a=e.meta)?void 0:a.title)||e.label||""}};c(()=>M.modelValue,e=>{e&&M.roleData});const I=()=>{var e;P.value=!1,null==(e=H.value)||e.setCheckedKeys([])},z=()=>{C.success("权限保存成功"),$("success"),I()},G=()=>{const e=H.value;if(!e)return;const a=e.store.nodesMap;Object.values(a).forEach(e=>{e.expanded=!L.value}),L.value=!L.value},J=()=>{const e=H.value;if(e){if(N.value)e.setCheckedKeys([]);else{const a=Q(A.value);e.setCheckedKeys(a)}N.value=!N.value}},Q=e=>{const a=[],l=e=>{e.forEach(e=>{var t;e.name&&a.push(e.name),(null==(t=e.children)?void 0:t.length)&&l(e.children)})};return l(e),a},R=()=>{const e=H.value;if(!e)return;const a=e.getCheckedKeys(),l=Q(A.value);N.value=a.length===l.length&&l.length>0},S=()=>{const e=H.value;if(!e)return;e.getCheckedKeys(),e.getHalfCheckedKeys(),e.getCheckedNodes(),e.getHalfCheckedNodes();const a=e.getCheckedKeys().length;e.getHalfCheckedKeys().length;C.success(`已输出选中数据到控制台，共选中 ${a} 个节点`)};return(e,a)=>{const l=K,t=E,s=_,r=x;return h(),i(r,{modelValue:v(P),"onUpdate:modelValue":a[0]||(a[0]=e=>j(P)?P.value=e:null),title:"菜单权限",width:"520px","align-center":"",class:"el-dialog-border",onClose:I},{footer:m(()=>[p(s,{onClick:S,style:{"margin-left":"8px"}},{default:m(()=>[...a[1]||(a[1]=[b("获取选中数据",-1)])]),_:1}),p(s,{onClick:G},{default:m(()=>[b(g(v(L)?"全部收起":"全部展开"),1)]),_:1}),p(s,{onClick:J,style:{"margin-left":"8px"}},{default:m(()=>[b(g(v(N)?"取消全选":"全部选择"),1)]),_:1}),p(s,{type:"primary",onClick:z},{default:m(()=>[...a[2]||(a[2]=[b("保存",-1)])]),_:1})]),default:m(()=>[p(t,{height:"70vh"},{default:m(()=>[p(l,{ref_key:"treeRef",ref:H,data:v(A),"show-checkbox":"","node-key":"name","default-expand-all":v(L),"default-checked-keys":[1,2,3],props:D,onCheck:R},{default:m(({data:e})=>[k("div",V,[e.isAuth?(h(),y("span",O,g(e.label),1)):(h(),y("span",w,g(D.label(e)),1))])]),_:1},8,["data","default-expand-all"])]),_:1})]),_:1},8,["modelValue"])}}});export{M as _};
