var e=Object.defineProperty,l=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,s=(l,a,t)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t;import{d as i,a as o,r as n,c as r,aJ as u,w as p,y as d,f as m,z as y,p as b,u as c,I as h,l as v,h as g,a8 as f,aa as k,dL as w,N as T,n as x,aB as _}from"./index-CKM1fen8.js";import{E as P}from"./el-dialog-CH-fnEoz.js";import"./el-overlay-Bft6Qiui.js";import{E as j}from"./el-button-DoyUgqJB.js";import{a as B,E}from"./el-radio-DvX9iq57.js";/* empty css                       *//* empty css                        */import"./tree-select-D3snXuk9.js";import{_ as H}from"./index.vue_vue_type_script_setup_true_lang-CtSKGHtD.js";import{E as I}from"./index-pB6x8TE-.js";const N={class:"dialog-footer"},V=i({__name:"menu-dialog",props:{visible:{type:Boolean,default:!1},editData:{},type:{default:"menu"},lockType:{type:Boolean,default:!1}},emits:["update:visible","submit"],setup(e,{emit:i}){const{width:V}=u(),D=(e,l)=>()=>f("span",{class:"flex items-center"},[f("span",e),f(I,{content:l,placement:"top"},()=>f(k,{class:"ml-0.5 cursor-help"},()=>f(w)))]),O=e,R=i,S=o(),U=o(!1),q=n({menuType:"menu",id:0,name:"",path:"",label:"",component:"",icon:"",isEnable:!0,sort:1,isMenu:!0,keepAlive:!0,isHide:!1,isHideTab:!1,link:"",isIframe:!1,showBadge:!1,showTextBadge:"",fixedTab:!1,activePath:"",roles:[],isFullPage:!1,authName:"",authLabel:"",authIcon:"",authSort:1}),A=n({name:[{required:!0,message:"请输入菜单名称",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],path:[{required:!0,message:"请输入路由地址",trigger:"blur"}],label:[{required:!0,message:"输入权限标识",trigger:"blur"}],authName:[{required:!0,message:"请输入权限名称",trigger:"blur"}],authLabel:[{required:!0,message:"请输入权限标识",trigger:"blur"}]}),L=r(()=>{const e=[{label:"菜单类型",key:"menuType",span:24}],l=V.value<640?12:6;return"menu"===q.menuType?[...e,{label:"菜单名称",key:"name",type:"input",props:{placeholder:"菜单名称"}},{label:D("路由地址","一级菜单：以 / 开头的绝对路径（如 /dashboard）\n二级及以下：相对路径（如 console、user）"),key:"path",type:"input",props:{placeholder:"如：/dashboard 或 console"}},{label:"权限标识",key:"label",type:"input",props:{placeholder:"如：User"}},{label:D("组件路径","一级父级菜单：填写 /index/index\n具体页面：填写组件路径（如 /system/user）\n目录菜单：留空"),key:"component",type:"input",props:{placeholder:"如：/system/user 或留空"}},{label:"图标",key:"icon",type:"input",props:{placeholder:"如：ri:user-line"}},{label:D("角色权限","仅用于前端权限模式：配置角色标识（如 R_SUPER、R_ADMIN）\n后端权限模式：无需配置"),key:"roles",type:"inputtag",props:{placeholder:"输入角色标识后按回车，如：R_SUPER"}},{label:"菜单排序",key:"sort",type:"number",props:{min:1,controlsPosition:"right",style:{width:"100%"}}},{label:"外部链接",key:"link",type:"input",props:{placeholder:"如：https://www.example.com"}},{label:"文本徽章",key:"showTextBadge",type:"input",props:{placeholder:"如：New、Hot"}},{label:D("激活路径",'用于详情页等隐藏菜单，指定高亮显示的父级菜单路径\n例如：用户详情页高亮显示"用户管理"菜单'),key:"activePath",type:"input",props:{placeholder:"如：/system/user"}},{label:"是否启用",key:"isEnable",type:"switch",span:l},{label:"页面缓存",key:"keepAlive",type:"switch",span:l},{label:"隐藏菜单",key:"isHide",type:"switch",span:l},{label:"是否内嵌",key:"isIframe",type:"switch",span:l},{label:"显示徽章",key:"showBadge",type:"switch",span:l},{label:"固定标签",key:"fixedTab",type:"switch",span:l},{label:"标签隐藏",key:"isHideTab",type:"switch",span:l},{label:"全屏页面",key:"isFullPage",type:"switch",span:l}]:[...e,{label:"权限名称",key:"authName",type:"input",props:{placeholder:"如：新增、编辑、删除"}},{label:"权限标识",key:"authLabel",type:"input",props:{placeholder:"如：add、edit、delete"}},{label:"权限排序",key:"authSort",type:"number",props:{min:1,controlsPosition:"right",style:{width:"100%"}}}]}),M=r(()=>{const e="menu"===q.menuType?"菜单":"按钮";return U.value?`编辑${e}`:`新建${e}`}),F=r(()=>!!U.value||!(U.value||"menu"!==q.menuType||!O.lockType)),C=()=>{return e=null,i=null,o=function*(){if(S.value)try{yield S.value.validate(),R("submit",((e,i)=>{for(var o in i||(i={}))a.call(i,o)&&s(e,o,i[o]);if(l)for(var o of l(i))t.call(i,o)&&s(e,o,i[o]);return e})({},q)),T.success((U.value?"编辑":"新增")+"成功"),$()}catch(e){T.error("表单校验失败，请检查输入")}},new Promise((l,a)=>{var t=e=>{try{n(o.next(e))}catch(l){a(l)}},s=e=>{try{n(o.throw(e))}catch(l){a(l)}},n=e=>e.done?l(e.value):Promise.resolve(e.value).then(t,s);n((o=o.apply(e,i)).next())});var e,i,o},$=()=>{R("update:visible",!1)},z=()=>{var e;null==(e=S.value)||e.reset(),q.menuType="menu",U.value=!1};return p(()=>O.visible,e=>{e&&(q.menuType=O.type,x(()=>{O.editData&&(()=>{var e,l,a,t,s,i,o,n,r,u,p,d,m,y,b,c,h,v,g,f,k,w,T,x,P;if(O.editData)if(U.value=!0,"menu"===q.menuType){const j=O.editData;q.id=j.id||0,q.name=_((null==(e=j.meta)?void 0:e.title)||""),q.path=j.path||"",q.label=j.name||"",q.component=j.component||"",q.icon=(null==(l=j.meta)?void 0:l.icon)||"",q.sort=(null==(a=j.meta)?void 0:a.sort)||1,q.isMenu=null==(s=null==(t=j.meta)?void 0:t.isMenu)||s,q.keepAlive=null!=(o=null==(i=j.meta)?void 0:i.keepAlive)&&o,q.isHide=null!=(r=null==(n=j.meta)?void 0:n.isHide)&&r,q.isHideTab=null!=(p=null==(u=j.meta)?void 0:u.isHideTab)&&p,q.isEnable=null==(m=null==(d=j.meta)?void 0:d.isEnable)||m,q.link=(null==(y=j.meta)?void 0:y.link)||"",q.isIframe=null!=(c=null==(b=j.meta)?void 0:b.isIframe)&&c,q.showBadge=null!=(v=null==(h=j.meta)?void 0:h.showBadge)&&v,q.showTextBadge=(null==(g=j.meta)?void 0:g.showTextBadge)||"",q.fixedTab=null!=(k=null==(f=j.meta)?void 0:f.fixedTab)&&k,q.activePath=(null==(w=j.meta)?void 0:w.activePath)||"",q.roles=(null==(T=j.meta)?void 0:T.roles)||[],q.isFullPage=null!=(P=null==(x=j.meta)?void 0:x.isFullPage)&&P}else{const e=O.editData;q.authName=e.title||"",q.authLabel=e.authMark||"",q.authIcon=e.icon||"",q.authSort=e.sort||1}})()}))}),p(()=>O.type,e=>{O.visible&&(q.menuType=e)}),(l,a)=>{const t=E,s=B,i=j,o=P;return m(),d(o,{title:c(M),"model-value":e.visible,"onUpdate:modelValue":$,width:"860px","align-center":"",class:"menu-dialog",onClosed:z},{footer:y(()=>[g("span",N,[b(i,{onClick:$},{default:y(()=>[...a[4]||(a[4]=[v("取 消",-1)])]),_:1}),b(i,{type:"primary",onClick:C},{default:y(()=>[...a[5]||(a[5]=[v("确 定",-1)])]),_:1})])]),default:y(()=>[b(H,{ref_key:"formRef",ref:S,modelValue:c(q),"onUpdate:modelValue":a[1]||(a[1]=e=>h(q)?q.value=e:null),items:c(L),rules:c(A),span:c(V)>640?12:24,gutter:20,"label-width":"100px","show-reset":!1,"show-submit":!1},{menuType:y(()=>[b(s,{modelValue:c(q).menuType,"onUpdate:modelValue":a[0]||(a[0]=e=>c(q).menuType=e),disabled:c(F)},{default:y(()=>[b(t,{value:"menu",label:"menu"},{default:y(()=>[...a[2]||(a[2]=[v("菜单",-1)])]),_:1}),b(t,{value:"button",label:"button"},{default:y(()=>[...a[3]||(a[3]=[v("按钮",-1)])]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1},8,["modelValue","items","rules","span"])]),_:1},8,["title","model-value"])}}});export{V as _};
